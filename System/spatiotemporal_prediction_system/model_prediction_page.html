<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>æ¨¡å‹é¢„æµ‹ç»“æœ - æ—¶ç©ºé¢„æµ‹ç³»ç»Ÿ</title>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: 
                linear-gradient(135deg, 
                    rgba(96, 165, 250, 0.95) 0%,
                    rgba(147, 197, 253, 0.9) 25%,
                    rgba(196, 181, 253, 0.9) 50%,
                    rgba(167, 139, 250, 0.9) 75%,
                    rgba(129, 140, 248, 0.95) 100%
                );
            min-height: 100vh;
            padding: 2rem;
            position: relative;
            overflow-x: hidden;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.25) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 60%);
            pointer-events: none;
            z-index: 0;
        }
        body::after {
            content: none;
        }
        .header {
            text-align: center;
            margin-bottom: 2rem;
            color: white;
            position: relative;
            z-index: 1;
        }
        .logo { font-size: 3rem; margin-bottom: 1rem; }
        .title { 
            font-size: 3rem; 
            font-weight: 800; 
            color: white;
            margin-bottom: 1rem;
            text-shadow: 0 8px 16px rgba(0, 0, 0, 0.3),
                        0 0 40px rgba(255, 255, 255, 0.1);
            letter-spacing: 0.5px;
        }
        .subtitle { 
            font-size: 1.25rem; 
            color: rgba(255, 255, 255, 0.95);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            font-weight: 500;
        }
        .container { max-width: 1600px; margin: 0 auto; position: relative; z-index: 1; }
        .nav-card { 
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.85) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px; 
            padding: 1.5rem; 
            margin-bottom: 2rem; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
        }
        .back-btn { 
            display: inline-block; 
            padding: 0.75rem 1.5rem; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            text-decoration: none; 
            border-radius: 8px; 
            font-weight: 600; 
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        .back-btn:hover { 
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }
        .model-selector { 
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.85) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px; 
            padding: 2rem; 
            margin-bottom: 2rem; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
        }
        .section-title { 
            font-size: 1.5rem; 
            font-weight: 700; 
            color: #1e293b; 
            margin-bottom: 1rem; 
            text-shadow: none;
        }
        .model-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem; }
        .model-btn { 
            padding: 1rem; 
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(102, 126, 234, 0.3);
            color: #334155; 
            border-radius: 10px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s; 
            font-size: 1rem; 
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .model-btn:hover { 
            transform: translateY(-3px); 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.5); 
        }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .stat-card { 
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-radius: 15px; 
            padding: 1.5rem; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.15); 
            text-align: center; 
        }
        .stat-label { font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem; font-weight: 500; }
        .stat-value { font-size: 2rem; font-weight: 700; color: #667eea; text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .chart-card { 
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-radius: 15px; 
            padding: 2rem; 
            margin-bottom: 2rem; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); 
        }
        .chart-title { 
            font-size: 1.5rem; 
            font-weight: 700; 
            color: #1e293b; 
            margin-bottom: 1rem;
            text-shadow: none; 
        }
        .chart-container { height: 450px; width: 100%; }
        .data-table { width: 100%; border-collapse: collapse; margin-top: 1rem; overflow-x: auto; }
        .data-table th, .data-table td { 
            padding: 0.75rem; 
            text-align: left; 
            border-bottom: 1px solid rgba(102, 126, 234, 0.1); 
            font-size: 0.9rem; 
            color: #334155;
        }
        .data-table th { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            font-weight: 600; 
            color: white; 
        }
        .data-table tr:hover { background: rgba(102, 126, 234, 0.08); }
        .loading { text-align: center; padding: 3rem; color: #64748b; font-size: 1.2rem; }
        .compare-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; }
        .model-comparison-card { 
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-radius: 15px; 
            padding: 2rem; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); 
        }
        .comparison-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        .comparison-table th, .comparison-table td { 
            padding: 1rem; 
            text-align: left; 
            border-bottom: 1px solid rgba(102, 126, 234, 0.1); 
            color: #334155;
        }
        .comparison-table th { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            font-weight: 600;
        }
        .comparison-table tr:hover { background: rgba(102, 126, 234, 0.08); }
        p { color: #475569; line-height: 1.6; }
        h3 { color: #1e293b; font-weight: 700; }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">ğŸ”®</div>
        <h1 class="title">æ¨¡å‹é¢„æµ‹ç»“æœ</h1>
        <p class="subtitle">12ç§æ—¶åºé¢„æµ‹æ¨¡å‹å¯¹æ¯”å±•ç¤º</p>
    </div>
    
    <div class="container">
        <div class="nav-card">
            <a href="http://localhost:8003/" class="back-btn">â† è¿”å›é¦–é¡µ</a>
        </div>
        
        <!-- æ¨¡å‹é€‰æ‹©å™¨ -->
        <div class="model-selector">
            <h2 class="section-title">é€‰æ‹©é¢„æµ‹æ¨¡å‹</h2>
            <p style="color: #cbd5e0; margin-bottom: 1rem;">ç‚¹å‡»æ¨¡å‹æŒ‰é’®æŸ¥çœ‹è¯¥æ¨¡å‹çš„è¯¦ç»†é¢„æµ‹ç»“æœï¼Œæˆ–é€‰æ‹©"å…¨éƒ¨å¯¹æ¯”"æŸ¥çœ‹æ‰€æœ‰æ¨¡å‹çš„æ•´ä½“å¯¹æ¯”</p>
            <div class="model-grid" id="modelGrid">
                <!-- æ¨¡å‹æŒ‰é’®å°†åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div class="stats-grid" id="statsGrid" style="display: none;">
            <div class="stat-card">
                <div class="stat-label">å½“å‰æ¨¡å‹</div>
                <div class="stat-value" id="statModel">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">é¢„æµ‹æ•°é‡</div>
                <div class="stat-value" id="statCount">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">å¹³å‡é¢„æµ‹å€¼</div>
                <div class="stat-value" id="statAvg">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">æœ€å¤§é¢„æµ‹å€¼</div>
                <div class="stat-value" id="statMax">-</div>
            </div>
        </div>
        
        <!-- å•æ¨¡å‹é¢„æµ‹ç»“æœ -->
        <div class="chart-card" id="singleModelSection" style="display: none;">
            <h2 class="chart-title" id="modelTitle">æ¨¡å‹é¢„æµ‹è¶‹åŠ¿</h2>
            <div id="modelChart" class="chart-container"></div>
            <div id="modelTable" style="margin-top: 2rem;"></div>
        </div>
        
        <!-- åŒºå¿æ¨¡å‹å¯¹æ¯” -->
        <div class="chart-card" id="districtCompareSection" style="display: none;">
            <h2 class="chart-title">ğŸ“ åŒºå¿æ¨¡å‹é¢„æµ‹å¯¹æ¯”</h2>
            <p style="color: #475569; margin-bottom: 1.5rem;">é€‰æ‹©åŒºå¿æŸ¥çœ‹æ‰€æœ‰æ¨¡å‹åœ¨è¯¥åŒºå¿çš„é¢„æµ‹æ•ˆæœï¼Œè“è‰²æ›²çº¿ä¸ºçœŸå®æ•°æ®ï¼Œå…¶ä»–é¢œè‰²ä¸ºå„æ¨¡å‹é¢„æµ‹</p>
            
            <!-- åŒºå¿é€‰æ‹©å™¨ -->
            <div class="model-grid" id="districtGrid" style="margin-bottom: 2rem;">
                <!-- åŒºå¿æŒ‰é’®å°†åŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <!-- åŒºå¿å¯¹æ¯”å›¾è¡¨ -->
            <div id="districtChart" class="chart-container"></div>
        </div>
        
        <!-- æ¨¡å‹å¯¹æ¯” -->
        <div class="chart-card" id="compareSection" style="display: none;">
            <h2 class="chart-title">å¤šæ¨¡å‹å¯¹æ¯”åˆ†æ</h2>
            <div id="compareChart" class="chart-container"></div>
            <div class="model-comparison-card" style="margin-top: 2rem;">
                <h3 style="color: #1e293b; margin-bottom: 1rem; font-weight: 700;">æ¨¡å‹æ€§èƒ½å¯¹æ¯”è¡¨</h3>
                <table class="comparison-table" id="compareTable"></table>
            </div>
        </div>
    </div>
    
    <script>
        let allModels = [];
        let currentModel = null;
        
        // åŠ è½½æ‰€æœ‰æ¨¡å‹åˆ—è¡¨
        async function loadModels() {
            try {
                const response = await fetch('/api/prediction-models');
                const result = await response.json();
                
                if (result.status === 'success') {
                    allModels = result.data;
                    renderModelButtons(allModels);
                } else {
                    document.getElementById('modelGrid').innerHTML = '<div style="color: #ef4444;">åŠ è½½æ¨¡å‹åˆ—è¡¨å¤±è´¥: ' + result.message + '</div>';
                }
            } catch (error) {
                document.getElementById('modelGrid').innerHTML = '<div style="color: #ef4444;">åŠ è½½å¤±è´¥: ' + error.message + '</div>';
            }
        }
        
        // æ¸²æŸ“æ¨¡å‹æŒ‰é’®
        function renderModelButtons(models) {
            let html = '';
            models.forEach(model => {
                html += `<button class="model-btn" onclick="selectModel('${model}')">${model}</button>`;
            });
            html += `<button class="model-btn" onclick="compareAllModels()" style="background: linear-gradient(135deg, #f5576c 0%, #f093fb 100%);">å…¨éƒ¨å¯¹æ¯”</button>`;
            document.getElementById('modelGrid').innerHTML = html;
        }
        
        // é€‰æ‹©å•ä¸ªæ¨¡å‹
        async function selectModel(modelName) {
            currentModel = modelName;
            
            // éšè—å¯¹æ¯”åŒºåŸŸï¼Œæ˜¾ç¤ºå•æ¨¡å‹åŒºåŸŸ
            document.getElementById('compareSection').style.display = 'none';
            document.getElementById('singleModelSection').style.display = 'block';
            document.getElementById('statsGrid').style.display = 'grid';
            
            try {
                // åŠ è½½æ¨¡å‹ç»Ÿè®¡æ•°æ®
                const statsResponse = await fetch(`/api/model-stats?model=${modelName}`);
                const statsResult = await statsResponse.json();
                
                if (statsResult.status === 'success') {
                    updateStats(statsResult);
                }
                
                // åŠ è½½æ¨¡å‹é¢„æµ‹æ•°æ®
                const dataResponse = await fetch(`/api/prediction-data/${modelName}`);
                const dataResult = await dataResponse.json();
                
                if (dataResult.status === 'success') {
                    updateModelChart(dataResult);
                    updateModelTable(dataResult);
                } else {
                    document.getElementById('modelChart').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥: ' + dataResult.message + '</div>';
                }
            } catch (error) {
                document.getElementById('modelChart').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥: ' + error.message + '</div>';
            }
        }
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStats(statsResult) {
            const stats = statsResult.stats;
            document.getElementById('statModel').textContent = statsResult.model;
            document.getElementById('statCount').textContent = statsResult.total_predictions;
            document.getElementById('statAvg').textContent = stats.avg_prediction ? stats.avg_prediction.toFixed(2) : '-';
            document.getElementById('statMax').textContent = stats.max_prediction ? stats.max_prediction.toFixed(2) : '-';
        }
        
        // æ›´æ–°æ¨¡å‹é¢„æµ‹å›¾è¡¨
        function updateModelChart(dataResult) {
            if (!dataResult.data || dataResult.data.length === 0) {
                document.getElementById('modelChart').innerHTML = '<div class="loading">æš‚æ— æ•°æ®</div>';
                return;
            }
            
            // æ‰¾åˆ°æ•°å€¼åˆ—
            const numericCols = [];
            dataResult.headers.forEach(header => {
                const values = dataResult.data.map(d => d[header]).filter(v => v !== null && v !== undefined && !isNaN(v));
                if (values.length > 0) {
                    numericCols.push({
                        name: header,
                        values: values.map(v => parseFloat(v))
                    });
                }
            });
            
            if (numericCols.length === 0) {
                document.getElementById('modelChart').innerHTML = '<div class="loading">æ— å¯è§†åŒ–æ•°æ®</div>';
                return;
            }
            
            // ä½¿ç”¨ç¬¬ä¸€ä¸ªæ•°å€¼åˆ—åˆ›å»ºå›¾è¡¨
            const col = numericCols[0];
            const layout = {
                title: currentModel + ' - ' + col.name + ' é¢„æµ‹è¶‹åŠ¿',
                xaxis: { title: 'æ—¶é—´åºåˆ—' },
                yaxis: { title: col.name },
                template: 'plotly_dark'
            };
            
            const trace = {
                x: Array.from({length: col.values.length}, (_, i) => i + 1),
                y: col.values,
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#667eea', width: 2 },
                marker: { size: 6 }
            };
            
            Plotly.newPlot('modelChart', [trace], layout);
        }
        
        // æ›´æ–°æ¨¡å‹æ•°æ®è¡¨æ ¼
        function updateModelTable(dataResult) {
            if (!dataResult.data || dataResult.data.length === 0) {
                document.getElementById('modelTable').innerHTML = '';
                return;
            }
            
            let html = '<h3 style="color: #f7fafc; margin-bottom: 1rem;">é¢„æµ‹æ•°æ®è¯¦æƒ…</h3><table class="data-table"><thead><tr>';
            dataResult.headers.slice(0, 8).forEach(header => {
                html += `<th>${header}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            dataResult.data.slice(0, 20).forEach(row => {
                html += '<tr>';
                dataResult.headers.slice(0, 8).forEach(header => {
                    const value = row[header] || '';
                    html += `<td>${value}</td>`;
                });
                html += '</tr>';
            });
            
            html += '</tbody></table>';
            html += `<p style="margin-top: 1rem; color: #cbd5e0;">æ˜¾ç¤ºå‰20æ¡æ•°æ®ï¼Œå…±${dataResult.total_rows}æ¡è®°å½•</p>`;
            
            document.getElementById('modelTable').innerHTML = html;
        }
        
        // å¯¹æ¯”æ‰€æœ‰æ¨¡å‹
        async function compareAllModels() {
            // éšè—å•æ¨¡å‹åŒºåŸŸï¼Œæ˜¾ç¤ºå¯¹æ¯”åŒºåŸŸ
            document.getElementById('singleModelSection').style.display = 'none';
            document.getElementById('statsGrid').style.display = 'none';
            document.getElementById('compareSection').style.display = 'block';
            document.getElementById('districtCompareSection').style.display = 'block';
            
            try {
                const response = await fetch('/api/compare-models');
                const result = await response.json();
                
                if (result.status === 'success') {
                    updateCompareChart(result);
                    updateCompareTable(result);
                } else {
                    document.getElementById('compareChart').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥: ' + result.message + '</div>';
                }
            } catch (error) {
                document.getElementById('compareChart').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥: ' + error.message + '</div>';
            }
            
            // åŠ è½½åŒºå¿å¯¹æ¯”æ•°æ®
            loadDistrictComparison();
        }
        
        // æ›´æ–°å¯¹æ¯”å›¾è¡¨
        function updateCompareChart(comparison) {
            if (!comparison.models || comparison.models.length === 0) {
                document.getElementById('compareChart').innerHTML = '<div class="loading">æš‚æ— å¯¹æ¯”æ•°æ®</div>';
                return;
            }
            
            const models = comparison.models.map(m => m.name);
            const avgs = comparison.models.map(m => m.avg.toFixed(2));
            
            const layout = {
                title: 'æ¨¡å‹å¹³å‡é¢„æµ‹å€¼å¯¹æ¯”',
                xaxis: { title: 'æ¨¡å‹' },
                yaxis: { title: 'å¹³å‡é¢„æµ‹å€¼' },
                template: 'plotly_dark'
            };
            
            const trace = {
                x: models,
                y: avgs,
                type: 'bar',
                marker: { color: '#667eea' }
            };
            
            Plotly.newPlot('compareChart', [trace], layout);
        }
        
        // æ›´æ–°å¯¹æ¯”è¡¨æ ¼
        function updateCompareTable(comparison) {
            if (!comparison.models || comparison.models.length === 0) {
                document.getElementById('compareTable').innerHTML = '';
                return;
            }
            
            let html = '<thead><tr><th>æ¨¡å‹åç§°</th><th>é¢„æµ‹æ•°é‡</th><th>å¹³å‡é¢„æµ‹å€¼</th><th>æœ€å¤§é¢„æµ‹å€¼</th><th>æœ€å°é¢„æµ‹å€¼</th></tr></thead><tbody>';
            
            comparison.models.forEach(model => {
                html += `<tr>
                    <td><strong>${model.name}</strong></td>
                    <td>${model.count}</td>
                    <td>${model.avg.toFixed(4)}</td>
                    <td>${model.max.toFixed(4)}</td>
                    <td>${model.min.toFixed(4)}</td>
                </tr>`;
            });
            
            html += '</tbody>';
            
            document.getElementById('compareTable').innerHTML = html;
        }
        
        // åŠ è½½åŒºå¿å¯¹æ¯”æ•°æ®
        let districtData = null;
        let currentDistrict = null;
        
        async function loadDistrictComparison() {
            try {
                const response = await fetch('/api/district-model-comparison');
                const result = await response.json();
                
                if (result.status === 'success') {
                    districtData = result.data;
                    renderDistrictButtons(result.data.districts);
                    // é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªåŒºå¿
                    if (result.data.districts && result.data.districts.length > 0) {
                        selectDistrict(result.data.districts[0]);
                    }
                } else {
                    document.getElementById('districtChart').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥: ' + result.message + '</div>';
                }
            } catch (error) {
                console.error('åŠ è½½åŒºå¿å¯¹æ¯”æ•°æ®å¤±è´¥:', error);
                document.getElementById('districtChart').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥: ' + error.message + '</div>';
            }
        }
        
        // æ¸²æŸ“åŒºå¿æŒ‰é’®
        function renderDistrictButtons(districts) {
            let html = '';
            districts.forEach(district => {
                html += `<button class="model-btn" onclick="selectDistrict('${district}')">${district}</button>`;
            });
            document.getElementById('districtGrid').innerHTML = html;
        }
        
        // é€‰æ‹©åŒºå¿
        function selectDistrict(district) {
            currentDistrict = district;
            updateDistrictChart(district);
        }
        
        // æ›´æ–°åŒºå¿å¯¹æ¯”å›¾è¡¨
        function updateDistrictChart(district) {
            if (!districtData || !districtData.district_data || !districtData.district_data[district]) {
                document.getElementById('districtChart').innerHTML = '<div class="loading">è¯¥åŒºå¿æš‚æ— æ•°æ®</div>';
                return;
            }
            
            const data = districtData.district_data[district];
            const traces = [];
            
            // æ·»åŠ çœŸå®æ•°æ®æ›²çº¿ï¼ˆè“è‰²ï¼ŒåŠ ç²—ï¼‰
            if (data.real_data && data.real_data.dates && data.real_data.values) {
                traces.push({
                    x: data.real_data.dates,
                    y: data.real_data.values,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: 'çœŸå®æ•°æ®',
                    line: { color: '#3b82f6', width: 4 },
                    marker: { size: 8, color: '#3b82f6' }
                });
            }
            
            // æ·»åŠ å„ä¸ªæ¨¡å‹çš„é¢„æµ‹æ›²çº¿
            const colors = ['#ef4444', '#f97316', '#f59e0b', '#84cc16', '#10b981', '#06b6d4', 
                           '#8b5cf6', '#ec4899', '#f43f5e', '#d946ef', '#14b8a6', '#fb923c'];
            let colorIndex = 0;
            
            if (data.models) {
                Object.keys(data.models).forEach(modelName => {
                    const modelData = data.models[modelName];
                    if (modelData && modelData.dates && modelData.values) {
                        traces.push({
                            x: modelData.dates,
                            y: modelData.values,
                            type: 'scatter',
                            mode: 'lines+markers',
                            name: modelName,
                            line: { color: colors[colorIndex % colors.length], width: 2 },
                            marker: { size: 5 }
                        });
                        colorIndex++;
                    }
                });
            }
            
            const layout = {
                title: district + ' - æ‰€æœ‰æ¨¡å‹é¢„æµ‹å¯¹æ¯”',
                xaxis: { 
                    title: 'æ—¥æœŸ',
                    tickangle: -45
                },
                yaxis: { title: 'ç—…å®³å‘ç”Ÿç¨‹åº¦' },
                hovermode: 'closest',
                showlegend: true,
                legend: {
                    x: 1.05,
                    y: 1,
                    orientation: 'v'
                },
                margin: { r: 150 }
            };
            
            Plotly.newPlot('districtChart', traces, layout, {responsive: true});
        }
        
        // é¡µé¢åŠ è½½æ—¶
        window.onload = loadModels;
    </script>
    
    <!-- åº•éƒ¨ç‰ˆæƒä¿¡æ¯ -->
    <footer style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 2rem 0; margin-top: 4rem; text-align: center; font-size: 0.9rem; line-height: 1.8;">
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 2rem;">
            <p style="margin: 0.5rem 0; font-weight: 600;">Â© 2025 AgriGuard Platform. åŸºäºå¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½çš„ç—…è™«å®³é¢„æµ‹é¢„è­¦ç³»ç»Ÿ</p>
            <p style="margin: 0.5rem 0;">æ•°æ®æ¥æºï¼šåŒ—äº¬å¸‚10åŒºå¿æ¤ç‰©è¯Šæ‰€ | 2018-2021å¹´æ—¶åºæ•°æ®</p>
            <p style="margin: 0.5rem 0;">æŠ€æœ¯æ”¯æŒï¼šæ—¶ç©ºé¢„æµ‹æ¨¡å‹ + æ·±åº¦å­¦ä¹  + å¤§è¯­è¨€æ¨¡å‹</p>
            <p style="margin: 0.5rem 0;">å¼€å‘å•ä½ï¼šä¸­å›½å†œä¸šå¤§å­¦ ä¿¡æ¯ä¸ç”µæ°”å·¥ç¨‹å­¦é™¢</p>
            <p style="margin: 0.5rem 0;">å¼€å‘å›¢é˜Ÿï¼šå¼ é¢†å…ˆæ•™æˆå›¢é˜Ÿ ç§¦æºæ³½ç­‰äºº</p>
        </div>
    </footer>
</body>
</html>

